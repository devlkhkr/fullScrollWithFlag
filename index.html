<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
    *{
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    html,body{
        width: 100%;
        height: 100%;
        scroll-behavior: smooth;
    }
    .wrapper_site,.wrapper_contents,.contents_box{
        width: 100%;
        height: 100%;
    }
    .contents_box:nth-child(1){
        background: rgb(193, 255, 174);
    }
    .contents_box:nth-child(2){
        background: rgb(186, 174, 255);
    }
    .contents_box:nth-child(3){
        background: rgb(255, 174, 174);
    }
    .scrollPreventDefault{
        overflow: hidden;
    }
</style>
<body>
    <div class="wrapper_site">
        <div class="wrapper_contents">
            <div class="contents_box">Cont_1</div>
            <div class="contents_box" id="target">Cont_2</div>
            <div class="contents_box">Cont_3</div>
        </div>
    </div>
</body>

<script>

    body = document.getElementsByTagName("body")[0];
    targetOffset = document.getElementById("target").offsetTop; //이동해야할 돔이 상단에서 떨어진 거리

    var flagForFullPageScroll = window.scrollY == 0 ? true : false; //사이트가 열리거나 새로고침 될 때 flag 상태

    window.scrollUpdater = document.documentElement.scrollTop || 0;

    document.addEventListener('scroll', function(){ // 스크롤 이벤트 발생
        let windowScrollTop = document.documentElement.scrollTop;
        let scrollDirection = windowScrollTop - window.scrollUpdater >= 0 ? 1 : -1; // 스크롤 방향 감지 ( 위로가면 -1, 밑으로가면 1 )

        window.scrollUpdater = windowScrollTop; // WindowScrollTop 업데이트

        setFlag(scrollDirection, event); //스크롤 방향을 파라미터로 들고 플래그 setFlag 함수로 이동
    });

    function setFlag(direction){
        if(direction === -1 && window.scrollY <= 0){ //위로 스크롤 할 때
            flagForFullPageScroll = true;
            //스크롤 방향이 위고 최상단에 도달하여 flag를 true로 변경
        }
        else{ //아래로 스크롤 할 때
            if(flagForFullPageScroll){
                doFullPageScroll(); //플래그가 true면 이벤트 발생
            }
            if(window.scrollY >= targetOffset){ //이동이 끝나면
                setTimeout(function(){
                    body.classList.remove("scrollPreventDefault") //500밀리초 이후 스크롤 허용
                },500)
            }
            flagForFullPageScroll = false;
            //스크롤 방향이 아래여서 flag를 false로 변경
        }
    }

    function doFullPageScroll(){ //스크롤 이벤트
        body.classList.add("scrollPreventDefault") //body 스크롤 막기
        window.scrollTo(0, targetOffset) //타겟돔으로 이동
    }

</script>

</html>
